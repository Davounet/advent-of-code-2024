const input = `MMMMMMMMMMMMWWWWWWWWAAAAAAAAAAAAAAAASSSSSSHHHIIHHHHHHHGGGGGGGGGXXXXXXXXEEEEEEENPMMMMMMMMMMPPPPPPPPPPPPPPPAAAHHPHHHHHHHHHHHHTTTTTTTTBBBBWWRRR
MMMMMMMMMMWWWWWWWWWAAAAAAAAAAAAAAAAASSSSSSHHHHHHHHHHGHGGGGGGGGGXXXXXXEEEEEEEENNNMMMMMMMMMMPPPPPPPPPPPPPPPAAAHHHHHHHHHHHHHHHDTTTTQTBBBBWWWWRR
MMMMMMMMMMMWWWWWWWWAAAAAAAAAAAAAAAAAASSSHHHHHHHHHHHHGGGGGGGGGGGXXXXXEEEEEENNNNNMMMMMMMMMMFPPPPPPPPPPPPPPPAAAHHHHHHHHHHHHHHHHTTTLTBBBBWWWWWWW
MMMMMMMMMMMWVWWWWAAAAAAAAAAAAAAAAAAASSSSHHHHHHHHHHTTGGGGGGGGGGXXXXXXEEEEEEENNNNNMMMMMMMMMPPPPPPPPPPPPPPPPPAAHHHHHHHHHHHHHHHHTTTTTBBBBBBWWWWW
MMMMMMMMMMWWWWWWWWAAAAAAAAAAAAAAAAAAAASSHHHHHHHHHHTHGGGGGGGGGGXXXXEEEEEEEEENNNNNMMMMMMMMMPPPPPPPPPPPPPPPPPRRHHHHHHHHHHHHHHHHTTTTBBBBBWWWWWWW
MMMMMMMMMWWWWWWWWWAAAAAAAAAAAAAAAAAAAAUSHHHHHHHHHHHHHGGGGGGGGGGXXXXEESEEEENNNNNMMMMMMMMPPPPPPPPPPPPPPPPPPPRRRHDDHHHHHHHHHHHHTTTTTTBBWWWWWWWW
MMMMMMMMMXWWWWWWWAAAAAAAAAAAAAAAAAAAAESSJHHHHHHHHHHHHGGGGGGGGGGGXXEEESEEEEEENNMMMMMMMMMPPPPPPPPPPPPPPPPGGPRRRRRRRHHHHHHHHHHRRRRTHHHBWWWWWWWW
MMMMMMMMMWWWWWWWWWAAAAHAAAAAAAAAAQADAAYJJJHHHHHHHHHHGGGGGGGGGGGGGXXXESSSSEEEEEMMMMMMMMMMPPPGPPPYPPPPPPGGRRRRRRRRRHHHHHHHHHHHRRRHHHHBWWWWLWWW
MWWMMMMWWWWWWWWWWAAAAAAAAAAAAQQAAQQRYYYYJJJHHHHHHHHGGGGGGGGGGGXSSXXXSSSSSSEEEEMMMMMMMMMMMPGGLPEYYPPPPPGGRRRRRRRRFHHHHHHHHHIHHHHHHHHHWDWWWWWW
MWWWMXXXWWWWWWWAAAAAAAAACAAAAAQQQQQRRYYYJJJHHHHHHHHGGGGGGGGGGGGSSSSSSSSSSSEEEMMMMMMMMMMMPPMLLEEEYPPPPGGGRTRRRRRFFHHHHHHHHHIIHHHHHHHHHDDDWWWW
WWWWWWWWZZWWWWWIAAAAAAMAMCMMMQQQQQQRYYYYHHHHHHHHHQHGGGQQGGGGQQGSSSSSSSSSSSSEMMMMKKKMMMMMMMMMLEEEEPPPPGGGRRRFFFRFFFFFHFHHHHHIHHHHHHHHHHHHWWWW
WWWWWWWZZZZWWWWOXAAOAAMMMMMMMQQQRRRRBYVVVVHHAHWHHQQGQQQQQQGGQQSSSSSSSSSSSSSEEMMMKKKKMMMMMMMLLEEEEFIIPGFFFFRFFFFFFFFFFFHHHFHHHHHHHHHHHHHHVWWW
WWWWWWWWZZZZZZZOXOOOOOMMMMMRMMQQRRRMRVVVVVHEEEHHQQQQQQQQQQQQQQQSSSSSSSSSSSSSEEEKKKKMMMMMMMNNQEEEEFFIPFFFFFFFFFFFFFFHFFFHFFHHHHHHHHHHHKHBWWWW
WWWWWWWWWZZZZZZOOOOOOOMMMMMMMMRRRLRMRRVVEEEEEEEHQEQQQQQQQQQQSSSSSSSSSSSSSSSSEEEECKKKMMMMMQQQQQQBFFFFFFFFFFFFFFFFFFFHHHHHHHHHHHHHHHHHHKWWWWWW
WWWWWWWWWZZZZZZZOOONNOMMMMMMMMMRRRRRRRRVEEEEEEEEEEEQQQQQQQQQQSSSSSSSSSSSSZZSEEEEKKKKKMMMKQQQBBBBBFNFFFFFFFFFFFFFFHHHHDDHYHHHHHHHHHHHHKKWWWWW
WWWWWWWFWWZZZZZZZZONNNMMMMMMMMQRRRRRRRREIEEEEEEEEEEQQPPPPPQQQQSSSSSSSSSSSSZSEEEKKKKKKKKKKQQQQQQBFFFFFFFFFFFFFFFFFHHHXXDXYHBHHHHHHHHHHKKKKWWK
WMMMMFFFFFFZFZZNZZNNNNMMMMFFMQQFRRRRRREEEEEEEEEEREEPQPPPPPQQQQBSSCSSSSSSSZZSSKKKKKKKKKKKKKQQQQQQMFFFFFFFFFFFFFHHHHHHXXXXXHBHHHHHHHHHHHKKKKKK
CMMMAFFFFFFFFFNNZNNNNNNNMMMFFFQFRRRRRRRRREEEETTTTRPPPPPPPPPQQQQQQSSSSSSSSZZZKKKKKKKKKKKKKQQQQQQQMFFFFFFFFFFFFFHHHHHXXXXXXXBHHHHHHUHHKKKKKKKK
CCMMMMFFFFFXXXXNNNNNNNMMMMFFFFFFFRRRRRSSEEEEETTTTSSPPPPPPPPQQQQRRRRRRSSZZZZZZKKKKKKKKQQQKQQQKQQQQQFFFFFFFMFFFFHHHHHXXXXXXXHHUHHHHUHHKKKKKKKK
MMMMMMMMXFFXXXXNNNNNNNNMFFFFFFFUUUURRRRSSSSESTTTTSSSPPPPPPPQQQQQRRRRRRZZZZZZZKKKKKKKKQQQQQQQQQQQQYFFFFFFMMFFFFHHHHHHXXXHHHUUUHUUHUHHKKKKKKKK
MMMSMMMMXXXXXXNNNNXNNNNLFFFFFFFFFFFERRVSSSSSSTTTTSSDJPPPPPPQQQQRRRRRZZZZZZZZZKKKKKKMMMMQQQQQQQQYYYYFFFFFMMMFFFHHHHHHHHXHHUUUUUUUUUUHHKKKKKKK
WMMSMMMMMMXXXXXXXXXXXFCFMFFFFFFFFFFELVTTTTTTTTTTTTTTTTPPPPPQQQQRRRRRRZZZZZZZSKKKKKKMQMMQQQQQQQQQQYYFFFFFFFMMMMHHHHHHHHHHUUUUUUUUUKUKKKKKKKKK
NMOMMMMMMXXXXXXXXXXXXFFFFFFFFFFFFFFLLLTTTTTTTTTTTTTTTTPPPPNQQQQRRRRRRZZZZZZGSKSSKVVSQQMQQQQQQQQQYYYYYFFFFFFMMHHHHHHHHHHHUUUUUUUUUKKKKKKKKKKK
NNMMMMMMMXXXXXXXXXXXFFXFFFFFFFFFFFFLLLTTTTTTTTTTTTTTTTZPPPNZZRRRRRRRRRRZZZSGSSSSSSSSBQQQQQQQQQQQQYYYYYFFFFFMMMHHHHHHHHHHHUUUUUUUUKKKKKKKKKKK
NNNNMMMMMNXXXXXXXXXXXXXFFFFFFFFFFFFFFLTTTTTTTTTTTTTTTTZPPPNZZZZZZRRVVVVZZSSSSSSSSSSSSQQQQQQQQQQQQQCYCYYFFFFMMMHHHHHHHHHHHUUUUUUUUUUKKKKKKKKK
NNNNMMNMMNNXXXXXXXXXXXXFFFFFFFFFFFFFFFTTTTTTTTTTTTTTTTPPPPZZZZZZVVVVVVVVVVSSSSSSSSSSSSQQQQQQQQQQQCCCCYYYBBBMMMMMHHHHHHHHUUUUUUUUUUUKKKKKKKKK
NNNNMRNNNNNNXXXXXXXXXFFFFFFFFFFFFFFFTTTTTTTTTTTTTTTTTTZZZZZZZZZUUUVVVVVVVVSSSSSSSSSSSSQQQQQQQQQHHCCGGBYBKBBMMMMMMMHHHHHHHUUUUUUUUKKKKKKKKKKK
NNNNNNNNNNNNXXXXXXXXXXFFQFFFFFFFFGFFTTTTTTTTTTTTTTTTTTZZZZZZZZUUUUUVVVVVVSSSSSSSSSSSSSPQQQQYYYQHHCCCGBYBBBBBBMMMMMMHHHHRREUUUUUUUUEEOOKKOOKK
NNNKKNNNNNNXXXXXXXXXXXXXXSFHFYFFFFQOTTTTTTTTTTTTTTTTTTZZZZZZZZUUUUVVVVMVVSSSSSSSSSSUSUPQQQYYMMMMHCCCWBBBBBBBBMMMMMMMHHHHEEEEEUUUUUEEEOKOOOKK
NNVKKNNNNNXXXXLXLLXXXXXXXXXHHYFFXQQQTTTTTTTTTTTTZZZZZZZZZZZZZZVVVVVVVVMMVSSSSSSSSSSUUUUBUUYYYMMMMCCWWWWBBWRRRMMMMMMEHHHHHHEEEUEUEEEEEOOOOOKO
NJVVKKNNNXXXXLLLLLLXXXXXXHHHHYYFXQQQTTTTTTTTTTGZZZZZZZZZZZZZZZQQVVVVVVMMMSSSSSSSSSSUUUUUUUUUMMMWWWWWWWWBBWRRRRRRMMMEEHHEHEEEEEEEEEEEEEEHOOOO
QJVVKKKNNXXXXLLLYYYYYYYXXXHYYYYYXQXQTTTTTTTTTTGZZZZZZZZZZZZZQQQVVVVVVVMMMMSMSSSSSFSCUUUUUUKMMMMWWWWWWWWWBWWRRRRRMMEEEHEEEEEEEEEEEEEEEEHHHOHO
QQVVKKKKNLLLLLLLLYYYYYYYYXHYYYYXXXXXQQBBBBQQBBBBBZZZZZZZZZQZQQQQVVVVVVVMMMMMSSFFFFSCSUUUUUUMMWWWWWWWWWWWWWRRRRRRMRLEEEEEEEEEEEEEEEEEEEHHHHHO
QQQQQKKKLLLLLLLLLLYYYYYYYXHYZYYYXXXQQQBBBBBBBBBBBNZZZZZZZFQQQVVVVVVVMMVMMMMMMFFFFFSSSUUUUUUUMWWWWWWWWWWRWWRRRRRRRRRZEEEEEEEEEEEEEEEEHEHHHHHO
QQQQLLLLLLLLLLLLLYYYYYYYYYHYYYYYXXXXXXXBBBBBBBBBBZZZZZZZZQQQQQVVVVVVVMMMMFFFFFFFFFSMUUUUUUPPWWWWWWWWWWWWRRRRRRRRRRRZEEEEEEEEEEEEEEEEHHHHHHHH
QQDDQQLLLLLLLLLLLYYYYYYYYYHYYYYYYXXXXXXBBBBBBBBBBBZZZZZZZQQQQQVVVQVVVMMMMFXFFFFFFFFFUUUUUUUPPWWWWWWWWWWRZRRRRRRRRRRREEEEEEEEEEEEEEEEHHHHHHHH
QQQQQQLLLLLLLLLLLLYYYYYYYYYYYYYYYYYXXXBBBBBBBBBBBBQQQZQQQQQQQVVZDDDMMMDMMMFFFFFFFFUUUUUUUUUUPPWWWWWWWWWRRRRRRRRRRRRCCEEEEEEEEEEEEEEEHHHHHHHH
QQQQQQQLLLLLLLLLLLLYYYYYYYYYYYYYYYYYBBJBBJBBBBBBBBQQQQQQQQQQQZZZDDDDDDDDFFFFFFFFFFUUUUUUUUUUPPWWWWWWWWWRRRRRRRRRRRCCCCCEEEEEEEEEEEEEHHHHHHHH
QQQQQQQQLLLLLLLLLLLLYYYYYYYYYYYYYYYYBBJJJJJBBBBBBBBQQQQQQQQQMMMMDDDDDDDDDFFFFFFFFFUUUUUUUUUPPPWWWWWWWWWWWRRRRRRRRRRCLLLLLEEEEEEEEEHHHHHHHHHH
QQQQQQQQLLLLLLLLLLLLLYYYYYYYYYYYYYRRDBBJJJJBBBBBBBBBQQQQQQQMMMMMMAADDDDDFFFFFFFFFUUUUUUUUNNNNNNNNNNWOWWWWRRRRRRRCCCCLLLLLLEEEEEEEEEHHHHHHHHH
QQQQQQQQLLLLLLLLLLLLLYYYYHYRRRYRYYRRDBBJJJJBBBBBBBBBQQQQQQQMMAAAAAADDDDDFFFFFFFFFFUUUUUUUNNNNNNNNNNWOWWWWRRRRRRJJJJJJLLLLLEEELEEEEHHHHHHHHHH
QQQQQQQQLLLLLLLLLLLLYYRRIRRRRRRRRYRRDBBJJJJBBBBBBBBBQQQQQQQQMAAAAAADDDDDFFFFFFFFFUUUUUFPPNNNNNNNNNNYWWWWWWJJJJJJJJJJJLLLLLELLLLEEEXHHHHHHHHH
QQQQQQQKKKLLLLLLLLCRYYRIIRRRRRRRRRRRRBBBJJBBBBBBZBBQQQQQQQTTXTTAIIIIYDDFFFFFFFFFCUCUUFFPPNNNNNNNNNNYWWWWYYJJJJJJJJJJJLLLLLLLLLLLLLHHHHHHHHHH
OQQQQKQKKKKKLLLLLLCRRRRRRRRRRRRRRRRRRBBBBBBBBBBBSRQQQQQQQQTTTTTTTIIIIIIFFFFFFFCFCCCCCFFFPNNNNNNNNNNYYYYYYYJJJJJJJJJJJTLIILLLLLLLLLLHHHHHHHHH
OQQQKKKKKKKKKLBBBRRRRRRRRRRRRRRRRRRRRBBBBBBBBSSSSRSQQQQQQQQQTTTTTTRRRRQQFFFFFFCCCCBBBFFFFNNNNNNNNNNYYYYYYYJJJJJJJJJJJTTIILLLLLLLLLLLHHHHHHHH
OOKKKKKKKKKKKXXRRRRRRRRRRRRRRRRRRRBRRRBBBBSSBSSSSSSQQQQQQQQQTTTTTTRRRRQFFFCFCCCCBBBBBFFPPNNNNNNNNNNYYYYTTYJJJJJJJJJJJTTTIILLLLLLLLLLHHHHHHHH
OOKKKKKKKKKKKXXXVRRRRRRXRRRRRRRRRBBBBBBBBSSSSSSSSSSQQQQQQQATTTTTTTRRRRRFFCCCCCCBBBBBBBBPPNNNNNNNNNNYYYYYTTJJJJJJJJJJJTTIIIIIILLLLLLLLHHHHHHH
OKKKKKKKKKKKKXXVVRRRRRRXXRRRRRRRBBBBBBBBBBSSSSSSSSSSQQQQTTTTTTTTTTRRRRRFRCCCCCCBBBBBBBBBBNNNNNNNNNNYYYYYYTJJJJJJJJJJJTIIIIIIILLLLLLLLHHHHHHH
OKKKKKKKKKKKKKKRRRRRRRRRXXXRRTRRBBBBBBBBBBSSSSSSSSSVQQQQQRTTTTKRRRRRRRRRRRRCCCCBBBBBBBBBBBBRYZZZYYYYYYHYYNTTJJJJJJJJJTIIIIIIILLLLLLLLLLHHHHH
OOLKKKKKKKKKKKKRRRRRRRRTRRRRRRRBBBBBBBBBSSSSSSSSSSSSQQQQRRRWWTKRRRRRRRRRRRCCCCCBBBBBBBBBBDZRYZZZYYYYYYHHYYTTJJJJJJJJJTTIIIITTLLLLLLLLLLKHHHH
LLLLKKKKKKKKKKKRRRRRRRRRRBBBBBBBBBBBBBBBSSSSSSSSSSNNNNNRRRRWWKKRRRRRRRRRRRCCCCBBBBBBBBBBBBZZYZZZZZYYYYHHHHHTJJJJJJJJJTTSIIITLLLLLLLLLLKKKHKK
CLLLLKKKKKKKKKKRRRRRRRRRRMBBBWBBBBBDDBBSSSSSSSSSSSNNNNNWWWWWWWWWRRRCCRRRRRRRCCCBBBBBBBBBBBBZZZZZZYYHHYHHHHHTTTTTXTTTTTTSSDSSLLLGGLLLLLLLKKKK
LLLBKKKKKKKKOKKRRRRRRRBRRBBBBBBBBBBTDDDQSSSSSSSSSSNNNNNWWWWWGGWWWRCCCCCRRRRRCCBBBBBBBBBSBBBZZZZZZZYYHHHHHHXXTTTXXXXXXXSSSSSSSLLGLLLLLLLKKKKK
LLLLLKKKKKKKOOOORRRRRRVVVVVBBBBBBBBDDQDQQQSSSSSSSSSSVWWJJWWWWWWWWCCCCCCCRRRRRCBBBBBBBBBBBBBZZZZZZZZYYHHHXXXXXXXXXXXXXXXSSSSSSSLGGLXXXXLJJJJJ
LLLLLWWWWKWKWWOOOOORROVVVVVVBBBBBBDDDQQQQQSNSSSSSSSVVVWWJWWWWWWWWCCCCCCRRTRRRCBPBBZBPPBBBBBZZZZZZZZDPPPHXLXXXXXXXXXXXXSSSSSSSGGGGOXXXJJJJJJJ
LLLLLLWWWWWWWOOOOOOOOOVVVVVVVBBBBBBDDDDQQQQSSSSSSSSSSVWWWWWWWWWWWCCCCCCCCRRRCCCPPBBBPPPPXXXXXZZZZZZDPPPPPPXXXXXXXXXVXXXVSSSSGGGGOOXJJJJJJJJJ
LLLLLLLLOWWWWOOOOOOOOOOOVVVVVBDBBBBBBQQQQQQSSSSSSSSSVVWWWWWWWWWWWCWCCCCCCRRRCCCPPPPPPPKXXXXXZZZZZZZPPPPPPPXXXXXXXXXVVVVVVGGGGGGOOOOJJJJJJJJJ
LLLLLLLLOOOOOOOOOOOOOOOOVVVVBBBBBBBBQQQQQQQQSSSSSSSSSWWWWWWWWWWCCCWWCWWCCCEECPPPPPPPPPXOOXXXYBZZAAPPPPPPPPPXXCCVVXXVVVVVVVGGGOOOOOOOOOJJJJJJ
LLLLLELLKOOOOOOOOOOOOOOVVVVVVVVBBBBBQQQQQQQSSSQSQSSSVVWWWWWWWWWWWCWWWWWWWWEECCCCPCPPPPXXXXXXBBZZZHHHPPPPPPPPPPPVVXVVVVVVGVGGGOOOOOOOOOJJJJJJ
LLLLEEKKKKKKOOOOOOOOOOOVVVVVVVVBBBBBQQQQQQQQSSQQQQQSVVVWWWWWWWWWWWWWWWWWWWEECCCCCCHHPXXXXXXXBBBBZHHHHPPPPPPPPPPVVVVVVVVVVVGGGOOOOOOOOOOOIIII
LLLLLLKKKKKKOOOOOOOOOOVVVVVVVVVVBBKKVQQQQQQQQSQQQQQSVVVWWWWWWWWWWWWWWWWWWWEEEEHHHHHHHQXXXXXXBBBBWBBHHPPPPPPPPPPVVVVVVVVVVVGGGGOOOOOOOOMOOIII
LLLLKKKKKKKKKKOOOOOOOOOVVVVVVVVVBVVVVVQQQQQQQQQQQQQSVVVWWWWWWWWUWWWWWWFWWWEEEHHHHHHQQQQXXWXXXBBBBBHHHPHPPPPPPPPVVVVVVVVVVVGGGGOOOOOOOOOOOOII
HHHHKKKKKKKKKKKOOOOOOVVVVVVVVVVVVVVVVVVQQQQQQQQQQGVVVVVVWWXXXWWHWWWWWWWWWWEEHHHHHHHQQQQQWWXXXBBBBBHHHHHHHPPPPPUVVVVVVVVVVVGGGGOOOOOOOOOOOIIM
HHHHKKKKKKKKKKOOOOOOVVVVVVVRRRVVRRRVVVVQQQQQQQQQVVVVVVVVVVXXXHHHWWWWWWWWWWWHHHHHHHHQQQWQWWXXXBBBBBHHHHHHHPPPPVVVVVVVVVVVVVGGJJJOOOOOOOOOMMMM
HHHHKKKKKKKKKKKKKOOOVVVRRRRRRRRRRRRRRVQQQQQQQQQQQMMVVVVVVVVXXHHHHWWWWWWWWWHHHHHHHHHHWWWWWWWXBBBBBHHHHHHHHHHPQQQVVVVVVVVVFFJJJJJOOOOOOOOMMMMM
HHHHKKKKKKKKKKKKKOOKKVRRRAARRRRRRRRRGVMQQQQSSQQQMMSFVVVVVVXXXXWWWWWWWWWWWWWHHHHHHHUWRWWWWWWXBBBBBHHHHHHHRHHHHQQQQQVVVVFFFFFJJJJBJJJOYOOMMMMM
HHHHKKKKKKKKKKKKKKZKVVRRRRRRRRRRRRRFVVOOQQQSSQQQMMSSVVVVVVXWWWWWWWWWWZZZZZVHHHHHHUUWWWWWWWPXBBBBCHHHHHHHRHHHRQQKKKVVVVVVVJJJJJJJJJJYYYMMMMMM
HHHKKKKKKKKKKKKKHKKKKKRRRRRRRRRRRRRFFFFOOQSSSSMMMSSSVVVVVXXXWWWWWWWWWZZZZZZHHHHHHUUWWWWWWWWWWWBCCHHHHHHRRRHHRQQQKKVVKVDVUUNNNJJJJJJJYMMMMMMM
HHHZKKKKKKKKKKKKKKKKKTRRRRRRRRRRRRRFFFOOOOSSSSSSSSSSSSXVXXXXXWWWWWWWWZZZZZZHHHHHUUUUWWWWWWWWWWWCCCHHHHRRRRRRRQQKKKKKKKKNNNNNNJJJJJJYYMMMMMMM
ZZHZKAKKZKKKKKKKKKKKKTRRRRRRRRRRRFFFFFOOOOSSSSSSSSSSSSXXXXXXWWWWWWWWZZZZZJZHHHHHUWUWWWWWWWWWWWWCCCHHRRRRRRRRRQKKKKKKKKNNNNNNNJJJYYYYMMMMMMMM
ZZHZZZZZZBKKKKKKKKKKKKRRRRRRRRRRRFFFFOOOOOSSSSSSSSSSSSSXXXXXXXWWWWWWZZZZZZZZHHHHUWWWWWWWWWWWWWSCCHCHRRRRRRRHRKKWKKKKKNNNNNNNNNNJJYYYMMMMMMMM
ZZZZZZZZZZZZKKKKKKKKKKRRRRRRRRRRRFFFOOOOOOBSSSSSSSSSSSXXXXXXXXXZWWWWZZZZZZZZZHHUUWWWWWWWWWWWWJSCCHCRRRVRRRRHRLKKKKKKNNNNNNNNNNYYNYYMMMMMMMMM
ZZZZZZZZZZZZKKKKKKKKKRRRRRRRRRRFRRRFFOOOOOBSSSSSSSSSSXXXXXXXXXXZZZZZZZZZZZZUUUUUUWWEWWWWWWSSSSSCCCCRRRRRRRHHKKKKKKKKNNNNNNNNNNNNNYMMMMMMMMMM
ZZZZZZZZZZZKKKKKKKKKKRRRRRRRRFFFFFRFOOOOOBBBBSSSSSSSSSXXXXXXXXXZZZZZZZZZZZZUUUUUUWWWBWSWWSSSSSRCCCCRCCRRHHHHKKKKKHKHNNNNNNNNNNYYYYYMMMMMMMMM
ZZZZZZZZZZZXXKKKKKKKKGGGGRRRFFFFFFFFFFOBBBBBBBNNSSSSSSXXXXXXXXXXWZCZZZZZZZZUUUUUUWWBBWSSSSSSSSSCCCCCCCCCCCCHHKKKKHHHNNNNNNNNNNNYYYYMYYMMMMMM
ZZZZZZZZZZZWWWWKKKKKKGGGGRRRFFFFFFBBBBBBBBBBBBBBSSSSSSSXXXXXXXXXWCCZZZZZZZUUUUUUUUUUBBSSSSSSSSSCSCCCCCCCCCCCCHHHHHHHHNOOONNNNNYYYYYYYYMMMMMM
ZZZZZZZZZZZWWWWKKKKKKGGGWFFRFFFFFFBBBBBBBBBBBZBBSSSSSXXXXXXXXXWWWCCZZZZZZZUUUUUUUUUUUBSSSSSSSSSSSSCCCCCCCCCCCHHHHHHHHHSONNNTNNYYYYYYYYMRMMMM
ZZZZZZZZZZWWWWWKKWKKKKWWWFFFFFFFFFFBBBBBBBBBZZZZZZSSSXXXXXXXXXWWWCCCZZZZZZZUUUUUUUUUUBSSSSSSSSSSSSSCCCCCCCCCUCHHHHHHHHSOTNNTTTTYYYHHHMMMMMMM
ZZZZZZZZZZWWWWWWWWKWWWWWWWFFFFFFFFFBBWBBBBBBZZZZZXXSSXXXXXXXXWWWWWCCZZZZZZZZZZUUUUUBBBSSSSSSSSSSSSCCCCACCCCCCCHHHHHSSSSSTTTTTTTHHHHHHHHHMMMM
ZZZZZXXXXXVWWWWWWWWWWWWFFFFFFFFFFFFBXBBBBBBBBBZZZXXSSXXXXXKKWWWWWWCCCZZZZZZZZZZUUUUUBBBSSSSSSSSSCCCCCAAACCCCCHHHHHSSSSSSTTTTTTBHHHHHHHHHMSSM
ZZXXXXXXXXXXWWWWWWWWWWWWFFFFFFFFFFFFXXXBBBZBBZZZZXXXXXXXXXKKKWWBWWWWZZZZZZZZZZKUUUUUBBBSSSSSSSSSCCCAAAACCCCCHHHHHHSSSSSTTTTTTTTTHHHHHHHHHSSS
ZXXOXXXXXXXXCWWWWWWWWWWWWFFFFFFFFFFFFXXBEZZZZZZZZZXXXXXXXXXKXXXBBWWBBBZBBZZZBBUUUUUUYBBSSSSSSSSSCCAAAAAQCCCCCAAASSSSSSSTTTTTTTTHHHHHHHHHHSSS
ZZXXXXXXXXXGXWWWWWWWWWWWWRFFFFFFFFFEXXEEEZEZZZZZZZXXXXXXXZXXXXXXBBBBBBBBBZZZBBBBBUUUYYYYSSSSSSSSSSQAAAAQQQQQQAAAASSASASTTQQTTTHHHHHHHHHSSSSS
ZZZXXXXXXXXXXWWWWWWWWWWWWWFFFFFFEEEEXXEEEEEEZZZZZXXVXXXXXXXXXXXXXBBBBBBBBZBBBBBBBBBUUWWYYYYYSSSSSSQQQAQQQQQQAAAAAAAAAAATTTTTTTHHHHHHHHHSSSSS
ZZZXXXXXXXXXXWWWWWWWWWWWWWIFFFFFFEEEXEEEEEEEZZZZXXXXZXXXXXXXXXXXXXBBBBBBBBBWBBBBBWWUWWYYYYYSSSSSQQQQQQQQQQQAAAAAAAAAAAYYYYTTTTHHHHHHHHHSSSSS
ZZXXXXXXXXXBXWWWWWWWWWWWWIIFFFFEEEEEEEEEEEEEEEZZZXXZZXXXXXXXXXXXBBBBBVBBBBBWWWWWWWWWWWWWYYYYSSSSSQQQQQQQQQQAAAAAAAAAAAYYYYTTTTTTHHUUHHHHSSSS
ZZZXXXXXXXXXXWWKWWKKEWWWWIIIIUFEEEEEEEEEEEEEEEEZZZXZZXZXXZXXXXXXXBBBVVBVBBWWWWWWWWWWWWWWYYYYSSSSSQQQXQXXQQQQQAAAAAAAAAYYGYTTTTTUUHUUUUUHSSSS
ZXXXXXXXXXXXXWWKKKKEKIWIIIIIIICCEEEEEEEEEEEEEEEZZZZZZZZZZZXXXXNNXBVVVVVVBBBWWWWWWWWWWWWYYYYYYSSQSQQQXXXXXXXQAAAAAAAAAAAAGGGTTTUUUUUUUUUHSSSS
ZZZZXYXXXXXXKWKKKKKKKIWUUUUIIICCCCEEEEEEEEEEEEZZZZZZZZZZZXXXXXNNTVVVVVVVVVBWWWWWWWWWWWWYYYYYYSSQQQQQQQQXXXXXAAAAAAAAAARAWWGGGTUUUUUUUUUUUSSS
ZZZXXXXXXXXXKKKKKKKKKKWUUUUUCCCCCCEEEEEEEEEEEEZUZUZZZZZZZZXXNNNNNVVVVVVVVVVUWWWWWWWWWWWYYYYYQQQQQQQQQXXXXXXCTAAAAAAAAAAAOWGGUUUUUUUUUUUUUUSS
ZZZZVVXXXXXXKKKKKKKKKKUUUUUUCCCCCCEEEEEEEEEEEEEUUUZZZZZZZZZNNNNNVVVVVVVVVVVVWWWWWWWWWYYYYQYYQQQQQQQQQQXXXXTTTTTAAAAAOOAOOGGUUUUUUUUUUUUUUUSS
ZZZVVVXXXVVWKKKKKKKKKKVUUUUUNCCCCCCEEBEEEEEUUUUUUUZZZZZZZZZZNNNNVVVVVVVVVVVWWWWWWWWWNQYYQQQQQQQQQQQQQQXXRXTTTTTAAAAAOOOOZGGUUUUUUUUUUUUUUSSS
ZZVVVVVVVVVVVVKKKKKKKUUUUUCCCCCCCCCCEEEEEEEUUUUUUUZZZZZZZZZZNNNNVLVVVVVVVVVVWWWWNNNNNQYQQQQQQQQQQQQQQQQQQTTTTAAAAAAAAOOJZZZUUUUUUUUUUUUUUSSS
ZZVVVVVVVVVVVVVKKUKUUUUUUUCCCCCCCCCCCCESSSEEUUUUUUZZZZZZZZZZNNNNVNVVVVVVVVVVWWWQQQQQQQQQQQQQQQQQQQQQQQQQQQQTVAAAAAAAAAOOZZZUXUUUUUUUUUUUUUSS
ZZVVVVVVVVVVVVVGKUUUUUUUUUUCCPCCCCCCCCCCSSEQUUUUUUZZZZZZZZNNNNNNNNVVVVVVVVVVZWWDQQQQQQQQQQQQQQQQQQQQQQQQQQQQAAAAAAAXXAAOXZZUUUUUUUUUUUCUSSSS
ZVVVVVVVVVVVVVVKKUUUUUUUUCCCCCCCCCCCCCCSSSVUUUUUZZZZZZZZZZZNNNNNDDDDVVVVVVVZZZWWXXXXXXQQQQAAQQQQQQQQQQQQQDDDAXXAAAAXXXXXXZZZZUZZUUZZZICIIIIS
ZVVVVVVVVVVVVVVUUUUUUUUUUUUCCCCCCCCCCHHVVVVUUUUUUZZZZZMMZZZNNNNNNDDDVVVVVVVCCCXXXXXXXXQQQAAALQQQQQQQQQQQQQQQXXXXXXAXXXXXXZZZZUUZUUZZIIIIIIII
ZVVVVVVVVVVVYYYUUUUUUUUUUUECAACCHCCCCHVVVVVUUUUUUZZZZZZMMZBNNNNNNNBDVVVVVCCCCCXXXCXXXXXXXLAALGGGQQQQQQQQQQQOQXXXXXXXXXXXZZZZZUUZZZZIIIIIIIII
ZVVVRRVVVVVVYJUUUUUUUUUEEEEEACCCCCCCCCVVVVVVUUUUUZZMZZMMMEMNNNNNKKBBVVVTCCCCCCXCCCCXXXXLLLLLLLLLQQQQQQQQQQQQQQXXXXXXXXXZZZZZZUZZZZZIIIIIIIII
IIIRRRRVVVVVJJJUUUUUYYYYYEEEECGGGGGGGGVVVVVVVVUHHHHMMMMMMMMNNNNNKBBBBBTTTCCCCCCCCCCXXCXLLLLLLLLLLQQQQQQQQQQQQQXXXXXXXXXZZRRZZZZZZZIIZIIIIIII
IIIIRRRRJVVVTTJUTTYYYYYYYEEEEEGGGGGGGGVVVVVVVVUHHHHHMMMMMMMMNNKKKBBBBBTTTTTCCCCCCCCCCCCCLLLLLLLLLLLLQQQQQQQQQQXXXXXXXXXXXRTRRRRZZZZZZIIIIIII
IRRRRRRJJVVVTTTTTTYYYYYYYYYEEGGGGGGGGGGVVVVVVVVHWHHHMMMMMMMMMMKKKBBBBGTTTCCCCCCCCCCCCCCCNNNLLLLLLLLLQQQQQQQQSQXXXXXXXTXXRRTRRRRZZOOOIIIIIIII
RRRRRRRRRDVTTTTTRTYYYYYYYYEEEGGGGGGGGGGVVVVVVWWWWWTTTMMMMMMMMMMKKBBBHGGGTCCCCCCCCCCCCCNNNNLLLLLLLLLLQQQQQQQQQQQXXXXXXTXRRRRRRRRRZOOOOOOIIIII
RRRRRRRIRDRRRRRTRRRGGEEEYEEEEGGGGGGGGGGVVVVVVWWWWWTTTMMMMMMMMMMKQQBBGGGGCCCCCCCCCCCCKNNNNNLLLLLLLLLPQVVVQQQQQHQXXXTXXTTZZRRRRRRRROOOOOOIIIII
RRRRRRRIRRRRRRRRRRRGNEEEEEEEEGGGGGGGGGGVVVVVWWWWWSTTTMMMMMMQMMQQQQQGGGGUCCCCCCCCCCCKKNNKLLLLLLLLLLLLQVVVVQYDTDDTTTTTXTTZTRRRRRRRRROOOOOOOIII
RRRRRRPRRRRRRRRRRRRGNEEEEEEEEGGGGGGGGGGVVVVVVWWWWWTTTMMMMMQQQQQQQQQZGGGGGCCCCCCCCCKKKKKKKKKKLLLLLLLVVVRVDDDDDDDTTTTTTTTTTEEERRRRROOOOOOOOOIN
RRRRRRPRRRRRRRRRRRRNNNNNNEEEEGGGGGGGGGGVVVVVVWWOZZTTTTTTTTTTTTQQQQVGGGGGGGGCCCCCCCKKKKKKKKKRLLLLLLLVRRRVVDDDDDDTTTTTTTTKKRRRRRRROOOOOOOOOIII
RRRRRRRRRRRRRRRRRRIINNNNNNNNEGGGGGGGGGGVVVVVVWUOOOTTTTTTTTTTTTQQQQGGGGGGGGYYYYCCCCKIKKKAKVKLLLLLLLDRRRRVVDDDDDDTTTTTTTTTKRRRRRROOOOOOOOOOOOI
RRRRRRRRRRRRRRRRRRRRNNNNNNMMMMMMMMMMMMMVVVVVVVHOOOTTTTTTTTTTTTQQQQGGGGGGGGGYYYCCCIIIIKAAVVKLLLVLFRRRRRRVREEDDDDTTTTTTTTTRRRRRRRROOOOOOOOOOOO
RRRRRRRRRRRRRRRRRRRRRNNNNNMMMMMMMMMMMMMHVVVHHHHOOOTTTTTTTTTTTTQQQQGGGGGGGGGGLLCCCIIIIIVVVVVVCVVRRRRRRRRRREEDDDDDTTTTTTTRRRRRDDRROOOOOOOOOOOO
RRRRRRRRRRRRRRRRRRBRNNNNNNMMMMMMMMMHHHHHHVVHHHHOOTTTTTTTWWWWWWWWWWGGGGGGGGGOLLLLLIIIIVVVVVVVCVVRRRRRRRRRRREDDDDDTTTRRTTTRRRRDHHOOOOOOOOOOOOO
RRRRRRRRRRRRRRRIRRHHNNNNNNMMMMMMMMMHHHHHHHVHOOOOOTTTTTQTWWWWWWWWWWGGGGGGGGGGGLLLLIIIIIVVVVVVVVVRRRRRRRRRRRROYDDDRTTRRRRRRRRDDDDOOOOOOOOOOOOO
RRRRRRRRRRRRRRRRRHHHHNNNNNMMMMMMMMMHHHHHHHHHHHHHGTTTTTOTWWWWWWWWWWWWWWGGGGGLLLLLLLLLIIVVVVVVVVVRRRRRRRRRRRROYYRRRRRRRRRRRRRDDDDDDOOOOOEOOOOO
RRRRRRRRRRERRRRRMSHHHHNNNNMMMMMMMMMMMHHHHHHHHHHHGTTTTTOTWWWWWWWWWWWWWWGGGGGLLLLLLLIIIIIIVVVVVVVRRRRRRRRRRROOOYRRRRRRRRRRRRRDWDDDDODOOOEOOOOO
RRRRRRRRERERRMMMMSSHHHHNNHMMMMMMMMMMMHHHHHHHGGGGGTTTTTOTWWWWWWWWWWWWWWGGGGLLLLLLLLIIIIIIVVVVVVVRRRRRRRRRRROOORRRRRRRRRRRRRRDDDDDDODDDDDDOOOO
RRNRRLEEEEEEEMMMSSSSSHHHHHMMMMMMMMMMMHHHHHHHHGGGGTTTTTOTWWWWWWWWWWWWWWGGUGLLLLLLLLLIIIIOOVVVVVVRRRRRRRRRROOOOORRRRRRRRRRRRRDDDDDDDDDDDDDOOOO
PPRRRRJJJEEEEEEMMSSSHHHHHHMMMMMMMMMMMHHHHGGGGGGGGTTTTTOTTTWWWWWWWWWWWWIGULLLLLULLLIIIIOOOOVVVVVVVVRRRRRRZOOOOOORRRRRRRRRRRRDDDDDDDDDDDDDDDOO
PPJJJJJJEEEEEESSMSSSHHHHHHHHMMMMMMMMMHHHHCGGGGGGGTTTTTTOWWWWWWWWWWWWWWKKULLLLLULLLIIOOOOVVVVVVVRRRROOROROOOOOOORRRRRRRRRRERDDDDDDDDDDDDDSOOO
PPJJJJJJEEEEEESSSSSSSHHHHHHHMMMMMMMMMNHHBNGGGGGGGTTTTTTTWWWWWWWWWWWWWWKKUULLUUULILIIIIIOVVVDVRRRRROOOOOOOOOOOOORRRRRRRRBJJJJJJDDDDDDDDDSSOOO
PJJJJJJJEEEEESSSSSSSSHHHHHMMMMMMMMMMMNHHBNGGGGGGGGOOOTTTWWWWWWWWWWWWWWKKUULRRRRRRRRIIIIIDDDDRRRRROOOCOOOOOOOOOORRRRRRNRRJJJJJJDDDDDDDDOSSSSS
JJJJJJJJEEEEESSSSSSSSSSSHHMMMMMMMMMMMNNNNNYGGGGGGGOOOTTTWWWWWWSSSGSLLKKKUUURRRRRRRRIIIIDDDDDDRRRROOOOOOOOOOOOOORRROHONNJJJRJDDDDDDDKDOOOSSSS
JJJJJJJEEEEEEECCCCSCSHHHHMMMMMMMMMMMMNNNNNGGGGGGGGTOTTTTWWWWWWSSSSSLLKKKKUKRRRRRRRRIIIIIDDDDDDRRDOOODOOOOOOOOOOOOOOOONNNRRRRDDDDDRRRDOSSSSSS
JJJJJJJEEEEEECCCCCCCCHHHHMMMMMMMOHNNNNNNNNHGGGGGGGTTTTTTTTTOSSSSSSLLLLKKKKKRRRRRRRRIIIIIDDDDDDRRDDDDDDAAOOOOOOOOOOOOOONNRRRRRDKRDRRRROOSSSSS
BBBEEEEEEEEEECCCCCCCCCHHHMMMMMMMOONNNNNNHHHHGGGGGGGTTTTTTTTTTSSSSSLLLLKKKKKRRRRRRRRIIIIDDDDDDDDDDDDDDDAAOOOOOOOOOOOOOONNRRRRRRRRRRRRGOOOSSSS
BBBEEEEEEEECECCCCCCTTTHHHMMMMMMMOOOOKNHHHHHGGGGGGGTTTTTTTTTTLLSSLLLLLLLLLKKRRRRRRRRIIIIIILLLDDDDDDDDDDDAOOOOOOOOOOONNNNNRRRRRRRRRRRRGOGSSSSS
BBEEEEEEEECCCNCCCCCTTTTHHMMMMMMOOOOOOHHHHHHEEGGTTTTTTTTTTPPFPLLSLLLLLLLLLKKRRRRRRRRIIIIIILLDDDDDDDDDDDDAOVOOOTOOOOONNNJRRRRRRRRRRRRRGGGGSSSS
BEEEEEEZZCKCCCCCCCCTTTTHHMMMMMMOOOOOOOHHHHEEEETTTTPPTTTTTPPPPPLLLLLLLLLLLKKRRRRRRRRIIIIIILLLDDDDDDDDDDDDYVOYTTTOMMMMJJJJJRRRRRRRRRRRGGGGGSSS
BBBEEEEEZCCCCCCCCCCCCTTTTMMMMMMOOOOOOOOHHELEEEETTPPPTTPPTPPPPPLLLLLLLLLEEKKKKKKIIIIIWWIIIILLLDDDDDDDDDDDYYYYYTYYYMMMJJJJJJRRRRRRRRRRGGGGGSGH
BBBBEEEEEELCCCCMCCCCCIIIIMMMMMMOOOOOOOHHHEEEEEETTTPPPTPPPPPPPLLLLLLLLLEEEKKKKKUIIIEEEWEIIILLLDDDDDDDDDDDYYYYYYYYYMMJJJJJJRRRRRRRRRLRGGGGGGGH
BBBQMMEKKKMTTCMMCICICIIIIIIIOOOOOOOOOOOHHEGEEEETTPPPPPPPPPPPPLLPPLBLLEEEEKKKKUUUUEEWWWEEIILLLLDDDDDDDDDDYYYYYYYYYMMMJJJJJRRRRRRRRRLLLGNGGGGG
BBQQQMQKQQMMMCCMMIIIIIIIIIIOOOOOOOOOOOOHHGGGGEETTTGPPPPPPPPPPPPPPPPEEEEEKKKKKUUEEEEWWEEEELLLLDDDDDDDDDYYYYYYYYYYMMMJJJJJJRRRRRRRRRRLGGNGGGGG
BBQQQQQQQQMMMMMMMIIIIIIIIIIOOOOOOOOOOOOOHGGGGEEGGTGGPPPPPPPPPPPPPPPEEEEEEKKKLEEEEEEEEEEEELLLLLDDDDDDDTYYYYYYYMMMMMMJJJJJJRRRRRRRPPRLGGGGGGGG
BBQQQQQQQQQMMMMMMMIIIIIIIIIOOOOOOJJOUOUUGGGGGGGGGGGGGPPPPPPPPPPPPPPPEEEEEEEKLLEEEEEEEEEEEELLLLLDDDDDTTYYYYYYYMMMJJJJJJJJJJJRREEPPPPGGGGGGGGG
QQQQQQQQQQQQLMMMMMMIIIIIIJIOOOOOOJDUUUUUGGGGGGGGGGGGGPPPPPPPPPPPPPPPEEEEEEEELLLEEEEEEEEEEZZLLLLDDLDTTTTYYYYYYMMMMJVJJJJJJRJEEEEEPPPPGGGGGGGG
DQQQQQQQQQQMMMUUUMMIIIIIIIIDOOOODDDUUUUUUGGGGGGGGGGGGGGGGPPPPPPFPPPPEEEEEEELLLLEEEEEEEEEEZZZLLLLLLLLYYYYYYMMMMMMMVVVVJJJJJJTEPPPPPPPGGGGGGGG
DQQQQQQQQQQUUUUUIIMIIIIIDDDDDOODDDDUUUUUUGGGGGGGGGGGGGGGGGPPPPPPLPPXEEEEEEELLLLEEEEEEEEEEZZZLLLLLLLLLQQYMMMMMMMMMVVVJJJJTTTTEEPMPPPPGGGGGOGG
QQQQQQQQQQQUUUQUIIIIIIIIDDDDDODDDDUUUUUUGGGGGGGGGGGGGGGWGPPPPPPPLPPEEEEEEELLLEEEEEEEEEEEEEZZZLLLLLLLLLQQMMMMMMMMMVVTCJJLTTTTEEMMMPPPPPGGGOOU
QQQQQQQQQQQQQQQINIIIIIIDDDDDDDDDDDDUUUUUGGGGGGGGGGGGGGGGGPPPPPPLLLLLEEEELLLLEEEEEEEEEEEEWZZZZLLLLLLLLLMMMMMMMMMMMVVTTTTTTTTTTMMMMPPPPPPPOOUU
QQQQQQQQQQQQQIIIIIIIIIIDDDDDDDDDDDDDUUGGGGGGGGGGGGGGGGGGJJPPPPPPPLLLLLLLLLLLLEEEEEEEEEEEZZZZZLLLLLLLLPPPMMMMMMMMMVVVVTTTTTTTTCMMPPPPPPOPOOUU
QQQQQQQQQQQQRRIIIIISIIIDDDDDDDDDDDDDDDDRGGGGGGGGGGGGGGGJJJJJPJPPLLLLLLLLLLLLLLEEEEEEEEEEZEZZZLLLLLPPPPPMMMMMMMMMMMMMVVTTTTTTTMMMMMMOOOOOOOUU`

const test = `RRRRIICCFF
RRRRIICCCF
VVRRRCCFFF
VVRCCCJFFF
VVVVCJJCFE
VVIVCCJJEE
VVIIICJJEE
MIIIIIJJEE
MIIISIJEEE
MMMISSJEEE`
const test2 = `EEEEE
EXXXX
EEEEE
EXXXX
EEEEE`
const test3 = `AAAAAA
AAABBA
AAABBA
ABBAAA
ABBAAA
AAAAAA`

const map = input.split('\n').map(r => r.split(''))
const limits = { x: map[0].length, y: map.length }
const regions = getRegions(map)

const cost1 = regions.reduce((s, r) => s + getFenceCost1(r), 0)
console.log({ cost1 })
const cost2 = regions.reduce((s, r) => s + getFenceCost2(r), 0)
console.log({ cost2 })

function getRegions(input) {
  const data = structuredClone(input).map(r => r.map(p => ({ plant: p, region: undefined })))

  let id = 1
  const regions = []
  data.forEach((row, y) => {
    row.forEach(({ plant, region }, x) => {
      if (!region) {
        const region = getRegion(data, [x, y], id++)
        regions.push(region)
      }
    })
  })

  return regions
}

function getFenceCost1(region) {
  const area = region.cells.length
  const perimeter = region.cells.reduce((s, c) => s + 4 - c.neighbours, 0)
  return area * perimeter
}

function getFenceCost2(region) {
  const area = region.cells.length

  const cells = new Set(region.cells.map(c => `${c.coords[0]},${c.coords[1]}`))
  const corners = new Set()

  region.cells.forEach(({ coords }) => {
    const [x, y] = coords
    const positions = [
      [x, y],
      [x + 1, y],
      [x + 1, y + 1],
      [x, y + 1]
    ]

    const detected = positions.map(coords => getCorners(coords, cells)).flat()
    detected.forEach(c => corners.add(c))
  })
  const sides = corners.size

  return area * sides
}

function getCorners([x, y], cells) {
  const list = []
  const tl = cells.has(`${x - 1},${y - 1}`)
  const tr = cells.has(`${x},${y - 1}`)
  const br = cells.has(`${x},${y}`)
  const bl = cells.has(`${x - 1},${y}`)

  if (!bl && tl && !tr) list.push(`${x},${y},tli`)
  if (!tl && tr && !br) list.push(`${x},${y},tri`)
  if (!tr && br && !bl) list.push(`${x},${y},bri`)
  if (!br && bl && !tl) list.push(`${x},${y},bli`)

  if (bl && !tl && tr && br) list.push(`${x},${y},tlo`)
  if (tl && !tr && br && bl) list.push(`${x},${y},tro`)
  if (tr && !br && bl && tl) list.push(`${x},${y},bro`)
  if (br && !bl && tl && tr) list.push(`${x},${y},blo`)

  return list
}

function getRegion(data, start, id) {
  const region = { id, cells: [] }
  const plant = data[start[1]][start[0]].plant

  const done = new Set()
  done.add(`${start[0]},${start[1]}}`)
  const next = [start]

  while (next.length) {
    const coords = next.shift()
    if (data[coords[1]][coords[0]].plant === plant) {
      data[coords[1]][coords[0]].region = id

      let neighbours = 0
      const moves = [
        [coords[0] + 1, coords[1]],
        [coords[0] - 1, coords[1]],
        [coords[0], coords[1] + 1],
        [coords[0], coords[1] - 1]
      ]
      moves
        .filter(inBounds)
        .filter(c => data[c[1]][c[0]].plant === plant)
        .forEach(c => {
          neighbours++
          key = `${c[0]},${c[1]}}`
          if (!done.has(key)) {
            done.add(key)
            next.push(c)
          }
        })

      region.cells.push({ coords: coords, neighbours })
    }
  }
  return region
}

function inBounds([x, y]) {
  return x >= 0 && y >= 0 && x < limits.x && y < limits.y
}
function dumpRegion(region) {
  Array.from({ length: limits.y }).forEach((_, y) => {
    const list = Array.from({ length: limits.x }).map((_, x) =>
      !!region.cells.find(c => c.coords[0] === x && c.coords[1] === y) ? 'X' : ' '
    )
    console.log(list.join(''))
  })
}
function dumpMap(input) {
  input.forEach(r => console.log(r.map(c => c.plant).join('')))
  input.forEach(r => console.log(r.map(c => c.region).join(' ')))
}
